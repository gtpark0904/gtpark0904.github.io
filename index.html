<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Image</title>
  <style>
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      background: #111;
    }
    .image-container {
      position: relative;
      max-width: 90%;
      max-height: 90%;
    }
    img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: auto;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(255,255,255,0.5);
      opacity: 0;
      transition: opacity 1.5s ease-in-out; /* smooth crossfade */
    }
    img.visible {
      opacity: 1;
    }
  </style>
</head>
<body>
  <div class="image-container">
    <!-- Two layers for crossfade -->
    <img id="img1" class="visible" 
         src="https://raw.githubusercontent.com/gtpark0904/gtpark0904.github.io/main/default.png" 
         alt="Image 1">
    <img id="img2" 
         src="" 
         alt="Image 2">
  </div>

  <script>
    const fallback = "https://raw.githubusercontent.com/gtpark0904/gtpark0904.github.io/main/default.png";
    const current = "https://github.com/gtpark0904/gtpark0904.github.io/releases/download/current_image/current.png?raw=true";

    const img1 = document.getElementById("img1");
    const img2 = document.getElementById("img2");

    let intervalId = null;
    let showingImg1 = true; // track which image is active

    function updateImage() {
      const newImg = new Image();
      newImg.src = current + "&t=" + new Date().getTime(); // cache-busting

      newImg.onload = () => {
        const nextImg = showingImg1 ? img2 : img1;
        const prevImg = showingImg1 ? img1 : img2;

        nextImg.src = newImg.src;

        // start fade
        nextImg.classList.add("visible");
        prevImg.classList.remove("visible");

        showingImg1 = !showingImg1;

        // âœ… stop refreshing once found
        if (intervalId) {
          clearInterval(intervalId);
          intervalId = null;
          console.log("current.png found. Refresh stopped.");
        }
      };

      newImg.onerror = () => {
        // keep fallback visible
        if (!img1.classList.contains("visible") && !img2.classList.contains("visible")) {
          img1.src = fallback;
          img1.classList.add("visible");
        }
      };
    }

    // keep checking every 10s until found
    intervalId = setInterval(updateImage, 10000);
    updateImage();
  </script>
</body>
</html>
